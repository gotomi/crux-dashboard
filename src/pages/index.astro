---
// Component Imports
import Metric from '../components/Metric.astro';

let title = 'CrUX Dashboard';




import data from '../_data/crux.json';



function compareByDistribution(a,b) {
            const x = a.histogram[0];
        const y = b.histogram[0];
        if (y < x ) return -1
        if (x > y ) return 1
        return 0;
}


function compareByP75(a,b) {
        const y = a.p75
        const x = b.p75;
        if (y < x ) return -1
        if (x > y ) return 1
        return 0;
}


function getMetric(metric) {
    return data.metrics.map(item => {
    let obj = item[metric];
    obj.url = item.url.replace("https://","");
        return obj
    }).sort(compareByDistribution);
}

// const metrics = [" FCP", " LCP", " FID", " CLS"]
let FCP = getMetric(" FCP");
let LCP = getMetric(" LCP");
let FID = getMetric(" FID");
let CLS= getMetric(" CLS");
---
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width">
    <title>{title}</title>
    <link rel="icon" type="image/x-icon" href="/favicon.ico" />
    <link rel="stylesheet" href="./style/global.css">

    <style>


        hr{
            width: 100%;
            margin: 30px 0;
            border: 0;
            border-bottom: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <main>
        <header>
            <div>
                <h1>CrUX Dashboard</h1>
            </div>
        </header>
        <section>

             {FCP.map(p => <Metric post={p} />)}
            <hr>
             {LCP.map(p => <Metric post={p} />)}
            <hr>
             {FID.map(p => <Metric post={p} />)}
            <hr>
             {CLS.map(p => <Metric post={p} />)}
             </section>
    </main>
</body>
</html>
